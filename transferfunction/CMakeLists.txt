cmake_minimum_required(VERSION 3.1.0 FATAL_ERROR)

set(ENABLE_CUDA ON CACHE BOOL "Enable CUDA modules")

if(${ENABLE_CUDA})

    set(TF_INTEGRATION_USE_CUDA OFF CACHE BOOL "Use CUDA for transfer function integration")

    file(GLOB TF_CUDA_SOURCES *.cuda.cu)
    file(GLOB TF_CUDA_HEADERS *.cuda.h)
    set(CUDA_SOURCES ${CUDA_SOURCES} ${TF_CUDA_SOURCES} PARENT_SCOPE)
    set(CUDA_HEADERS ${CUDA_HEADERS} ${TF_CUDA_HEADERS} PARENT_SCOPE)

    file(GLOB TF_SOURCES *.cpp)
    file(GLOB TF_HEADERS *.h)
    file(GLOB TF_SHADERS *.vert *.frag)
    set(SOURCES ${SOURCES} ${TF_SOURCES} PARENT_SCOPE)
    set(HEADERS ${HEADERS} ${TF_HEADERS} PARENT_SCOPE)
    set(SHADERS ${SHADERS} ${TF_SHADERS} PARENT_SCOPE)

    if(${TF_INTEGRATION_USE_CUDA})
        set(TF_DEFINITIONS -DTF_INTEGRATION_USE_CUDA)
    else(${TF_INTEGRATION_USE_CUDA})
        set(TF_DEFINITIONS -DTF_INTEGRATION_USE_GL)
    endif(${TF_INTEGRATION_USE_CUDA})
    set(DEFINITIONS ${DEFINITIONS} ${TF_DEFINITIONS} PARENT_SCOPE)

else(${ENABLE_CUDA})

    file(GLOB TF_SOURCES *.cpp)
    file(GLOB TF_HEADERS *.h)
    file(GLOB TF_SHADERS *.vert *.frag)
    file(GLOB TF_SOURCES_CUDA *cuda.cpp)
    file(GLOB TF_HEADERS_CUDA *cuda.h)
    list(REMOVE_ITEM TF_SOURCES ${TF_SOURCES_CUDA})
    list(REMOVE_ITEM TF_HEADERS ${TF_HEADERS_CUDA})
    set(SOURCES ${SOURCES} ${TF_SOURCES} PARENT_SCOPE)
    set(HEADERS ${HEADERS} ${TF_HEADERS} PARENT_SCOPE)
    set(SHADERS ${SHADERS} ${TF_SHADERS} PARENT_SCOPE)

    set(TF_DEFINITIONS -DTF_INTEGRATION_USE_GL)
    set(DEFINITIONS ${DEFINITIONS} ${TF_DEFINITIONS} PARENT_SCOPE)

endif(${ENABLE_CUDA})
